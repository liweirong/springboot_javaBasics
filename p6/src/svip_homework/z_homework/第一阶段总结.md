
为什么hash的容量必须是2的幂等？ 最靠近我传进去的值的2的幂等
hash   put

hash值 & （n-1）  n代表的是我的容量

扰动函数    减少hash冲突


假如我的hash 值

1110 11111101 1111   hash值来决定我在哪里

                         1010  &  ^  |  >>  <<

----------------------------------

                         1010

2的幂等，我的hash结果只跟扰动函数有关

如果不是2的幂等，跟扰动函数有关、容量有关



减少hash冲突的方式还有哪些？

1.容量有关，容量越大，hash冲突越小
2.rehash





解决hash冲突的办法？

1.链地址法
2.线性探测
3.再次hash



重入锁我必须拿到的东西？

1.互斥的条件   ------

2.线程信息

3.重入次数

  ReentrantLock重入锁





阻塞队列为什么要2个condition（条件唤醒）？

性能

生成  消费者

生成者--------唤醒---消费者

消费------------唤醒---生产者





Join的原理

wait 、synchronize



threadLocal

软引用

为什么ThreadKey设置为弱引用？

key  threadLocal



ThreadLocal的内存结构？



1.高速缓存会导致  数据一致性

2.引入MESI

   M   修改    缓存数据跟主内存数据不一样
   E  独占  只缓存在当前CPU，。没有被修改
   S  共享的，多个CPU并且与主内存一直
   I   失效

3.MESI带来性能问题

4.读写缓存 （开启的）解决性能问题，  所以又带来了可见性与 有序性问题

5.java  volatile  去关闭读写缓存   解决可见性与 有序性问题



性能  与 数据一致性

时间与空间

ThreadLocal     清理到null为止   时间空间的平衡





线程池原理画出来





任何事情一定要拿到结果



996   



不要消极





0.75

太小  一直扩容,性能

太大   导致，可能用不着  内存浪费







源码

最大 

没有区别  回收 的时候  都是一样

根据配置来的
